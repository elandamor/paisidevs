"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),Player=function(){function t(){_classCallCheck(this,t),this.videos=Array.from(document.querySelectorAll(".c-card-media")),this.playerHolder=document.querySelector(".media-player-holder"),this.player=document.querySelector(".media-player"),this.playerClose=document.querySelector(".media-player .bttn-close"),this.getFirstBCR=this.getFirstBCR.bind(this),this.getLastBCR=this.getLastBCR.bind(this),this.invert=this.invert.bind(this),this.play=this.play.bind(this),this.flip=this.flip.bind(this),this.flipIn=this.flipIn.bind(this),this.flipOut=this.flipOut.bind(this),this.flipPlayer=this.flipPlayer.bind(this),this.addEventListeners()}return _createClass(t,[{key:"addEventListeners",value:function(){var t=this;this.videos.forEach(function(e){e.addEventListener("click",function(e){t.target=e.target,t.flipPlayer()})}),this.player.addEventListener("click",function(e){var i=t.videos.indexOf(t.target),s=function a(e){t.player.classList.remove("is-animating"),t.player.removeEventListener("transitionend",a)};t.firstBCR=t.player.getBoundingClientRect(),t.player.classList.remove("is-opened"),t.lastBCR=t.player.getBoundingClientRect(),t.player.style.transform="translateY("+180*i+"px)",t.lastBCR=t.player.getBoundingClientRect();Math.abs(t.lastBCR.width/t.firstBCR.width),Math.ceil((t.lastBCR.width-t.firstBCR.width)/2),Math.ceil((t.firstBCR.height-t.lastBCR.height)/2+180*i);t.player.style.transform="translate(0,"+180*i+"px)",t.lastBCR=t.target.getBoundingClientRect(),t.player.classList.add("is-animating"),t.player.style.willChange="transform",t.player.style.transform="none",movie.scroller.classList.remove("is-faded-out"),movie.sidebarR.style.willChange="initial",movie.sidebarR.style.transform="none",t.player.addEventListener("transitionend",s)})}},{key:"flip",value:function(){return this.target.classList.contains("is-opened")?void this.flipOut():void this.flipIn()}},{key:"flipIn",value:function(){var t=this,e=(this.videos.indexOf(this.target),function i(e){t.target.classList.remove("is-animating"),t.target.style.zIndex="0",t.target.removeEventListener("transitionend",i)});this.target.style.zIndex="1",this.getFirstBCR(),this.target.classList.add("is-opened"),this.getLastBCR(),this.invert(),this.target.classList.add("is-animating"),this.play(),this.target.addEventListener("transitionend",e)}},{key:"flipOut",value:function(){var t=this,e=(this.videos.indexOf(this.target),function i(e){t.target.style.zIndex="0",t.target.removeEventListener("transitionend",i)});this.getFirstBCR(),this.target.classList.remove("is-opened"),this.getLastBCR(),this.invert(),this.play(),this.target.style.zIndex="0",this.target.addEventListener("transitionend",e)}},{key:"flipPlayer",value:function(){var t=this,e=this.videos.indexOf(this.target),i=function l(e){t.player.classList.remove("is-animating"),t.player.removeEventListener("transitionend",l)};if(!this.player.classList.contains("is-opened")){movie.scroller.classList.add("is-faded-out"),movie.sidebarR.style.willChange="transform",movie.sidebarR.style.transform="translateX(100%)",movie.sidebarR.style.transition="transform .15s cubic-bezier(0.4, 0.0, 0.2, 1)",this.player.style.transform="translateY("+180*e+"px)",this.firstBCR=this.player.getBoundingClientRect(),this.player.classList.add("is-opened"),this.lastBCR=this.player.getBoundingClientRect(),this.player.style.transform="translateY(-"+(this.lastBCR.top-24-180*e-64)+"px)",this.lastBCR=this.player.getBoundingClientRect();var s=24,a=Math.abs(this.firstBCR.width/this.lastBCR.width),n=Math.ceil((this.lastBCR.width-this.firstBCR.width)/2+s),r=Math.ceil((this.firstBCR.height-this.lastBCR.height)/2-s+180*e);this.player.style.transform="translate("+n+"px,"+r+"px) scale("+a+")",this.lastBCR=this.target.getBoundingClientRect(),this.player.classList.add("is-animating"),this.player.style.willChange="transform",this.player.style.transform="none",this.player.addEventListener("transitionend",i)}}},{key:"getFirstBCR",value:function(){this.firstBCR=this.target.getBoundingClientRect(),console.log("firstBCR",this.firstBCR)}},{key:"getLastBCR",value:function(){this.lastBCR=this.target.getBoundingClientRect(),console.log("lastBCR",this.lastBCR)}},{key:"invert",value:function(){var t=24,e=Math.abs(this.firstBCR.width/this.lastBCR.width),i=Math.ceil(this.lastBCR.width-this.firstBCR.width+t),s=Math.ceil(this.firstBCR.top-this.lastBCR.top-t);this.target.style.transform="translate("+i+"px,"+s+"px) scale("+e+")"}},{key:"play",value:function(){this.target.style.willChange="transform",this.target.style.transform="none"}}]),t}();new Player;